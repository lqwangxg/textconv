## 間隔時間: 1.5秒
interval: 1500
shotcmd_before: []
shotcmd_after: [open, popup, click,switchwindow]
shotfromstep: 16
shotskip: [42,43,44]
actions:
  #step:1
  - command: var
    target: routeX
    value: 1

  #step:2tenant取得の為
  - command: open
    target: http://localhost:8080/imart/system/login
    value: 

  #step:3login画面
  - command: open
    target: http://localhost:8080/imart/login
    value: 

  #step:4
  - command: wait
    target: 
    value: 1000

  #step:5
  - command: resize
    target: window
    value: 1000x900

  #step:6ID入力
  - command: overwrite
    target: id=im_user
    value: wangxg

  #step:7
  - command: wait
    target: 
    value: 1000

  #step:8
  - command: click
    target: css=.imui-btn-login
    value: 

  #step:9
  - command: label
    target: draft01
    value: 

  #step:10#起票画面 
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_entry
    value: 

  #step:11
  - command: switchTo
    target: frame
    value: IM_MAIN

  #step:12
  - command: switchTo
    target: frame
    value: 0

  #step:13DropDown選択
  - command: click
    target: XPath=//*[@name="category"]
    value: 

  #step:14Opion選定
  - command: click
    target: XPathFormat=//option[. = '{0}']
    value: 1800_JAE-US

  #step:15検索
  - command: click
    target: name=search
    value: 

  #step:16#特定WFへ
  - command: click
    target: XPathFormat=//*[contains(text(),"{0}")]/parent::tr/td[1]/a
    value: 1800_Entertainment(Acctg)

  #step:17
  - command: wait
    target: 
    value: 1000

  #step:18＃BPW申請－共通
  - command: switchTo
    target: DefaultContent
    value: 

  #step:19上部のBPWフロー詳細
  - command: switchTo
    target: frame
    value: 0

  #step:20
  - command: switchTo
    target: frame
    value: 0

  #step:21
  - command: overwrite
    target: id=5hxa4abl67jb6e9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:22
  - command: overwrite
    target: id=5hxa4abnxrrdhe9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:23
  - command: overwrite
    target: id=5hxa4abpv9xgbe9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:24
  - command: overwrite
    target: id=5hxa4abp2lsefe9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:25
  - command: overwrite
    target: id=5hxa4abrilci7e9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:26
  - command: overwrite
    target: id=5hx8wnpmmrka5e9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:27
  - command: overwrite
    target: id=5hx8wnpr1eieme9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:28
  - command: overwrite
    target: id=5hx8wnt10p5upe9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:29
  - command: overwrite
    target: id=5hx8wnpxlgthne9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:30
  - command: overwrite
    target: id=5hx8wnt4h48xve9
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:31登録・更新の切替
  - command: click
    target: Xpath=//a[contains(@onclick, "submitAction")]
    value: 

  #step:32＃BPW申請－共通
  - command: switchTo
    target: DefaultContent
    value: 

  #step:33
  - command: switchTo
    target: frame
    value: 0

  #step:34下部の共通入力Frame
  - command: switchTo
    target: frame
    value: 1

  #step:35
  - command: wait
    target: 
    value: 1000

  #step:36案件名称
  - command: type
    target: name=process_name
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:37
  - command: type
    target: name=draft_comment
    value: name=draft_comment:1800_Entertainment-Acctg--2021-04-05-100902

  #step:38
  - command: type
    target: name=mail_subject
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:39
  - command: type
    target: name=mail_body
    value: name=mail_body:1800_Entertainment-Acctg--2021-04-05-100902

  #step:40＃mailto:ユーザ検索画面
  - command: popup
    target: linktext=検索
    value: 2000

  #step:41
  - command: wait
    target: 
    value: 2000

  #step:42
  - command: click
    target: linktext=検索
    value: 

  #step:43
  - command: click
    target: css=table:nth-child(9) strong > a:nth-child(2) > img
    value: 

  #step:44
  - command: click
    target: css=tr:nth-child(7) > .list_data_bg > input
    value: 

  #step:45
  - command: click
    target: css=tr:nth-child(8) > .list_data_bg > input
    value: 

  #step:46
  - command: click
    target: css=tr:nth-child(9) > .list_data_bg > input
    value: 

  #step:47決定
  - command: click
    target: name=regist
    value: 

  #step:48
  - command: click
    target: linktext=閉じる
    value: 

  #step:49メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:50
  - command: switchTo
    target: frame
    value: 0

  #step:51下部の共通入力Frame
  - command: switchTo
    target: frame
    value: 1

  #step:52＃添付ファイル登録画面
  - command: popup
    target: linktext=添付ファイル登録
    value: 2000

  #step:53
  - command: wait
    target: 
    value: 2000

  #step:54
  - command: sendkeys
    target: name=content
    value: C:\tool\textconv\bin\WebDriver.xml

  #step:55
  - command: click
    target: name=regist
    value: 

  #step:56
  - command: sendkeys
    target: name=content
    value: C:\tool\textconv\bin\WebDriver.xml

  #step:57
  - command: overwrite
    target: name=changeName
    value: atachfile00002

  #step:58
  - command: click
    target: name=regist
    value: 

  #step:59
  - command: click
    target: linktext=閉じる
    value: 

  #step:60メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:61
  - command: switchTo
    target: frame
    value: 0

  #step:62下部の共通入力Frame
  - command: switchTo
    target: frame
    value: 1

  #step:63
  - command: click
    target: name=save
    value: 

  #step:64
  - command: switchTo
    target: alert
    value: 

  #step:65
  - command: wait
    target: 
    value: 1000

  #step:66
  - command: sendkeys
    target: 
    value: "{enter}"

  #step:67メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:68
  - command: switchTo
    target: frame
    value: IM_MAIN

  #step:69ルート変数チェック
  - command: ifvar
    target: routeX=1;goto:route1
    value: 

  #step:70
  - command: wait
    target: 
    value: 1

  #step:71ルート変数チェック
  - command: ifvar
    target: routeX=2;goto:route2
    value: 

  #step:72
  - command: wait
    target: 
    value: 1

  #step:73
  - command: label
    target: route1
    value: 

  #step:741回目承認の場合
  - command: var
    target: routeX
    value: 2

  #step:75ルーt１を選択
  - command: click
    target: xpath=//img[contains(@onclick, "callNewEntry('00000000000000000001'")]
    value: 

  #step:76ルーt１を選択
  - command: jump
    target: goto:approve
    value: 

  #step:77
  - command: label
    target: route2
    value: 

  #step:782回目承認の場合
  - command: var
    target: routeX
    value: 3

  #step:79ルーt２を選択
  - command: click
    target: xpath=//img[contains(@onclick, "callNewEntry('00000000000000000002'")]
    value: 

  #step:80ルーt１を選択
  - command: jump
    target: goto:approve
    value: 

  #step:81
  - command: label
    target: approve
    value: 

  #step:82
  - command: wait
    target: 
    value: 1

  #step:83
  - command: switchTo
    target: alert
    value: 

  #step:84
  - command: sendkeys
    target: 
    value: "{enter}"

  #step:85
  - command: sendkeys
    target: 
    value: "{enter}"

  #step:86
  - command: wait
    target: 
    value: 1

  #step:87起票済案件一覧（本人用）
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_assued
    value: 

  #step:88
  - command: wait
    target: 
    value: 1

  #step:89
  - command: label
    target: im_bpw_not_comp
    value: 

  #step:90未処理案件一覧（本人用）
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_not_comp
    value: 

  #step:91
  - command: wait
    target: 
    value: 1

  #step:92
  - command: switchTo
    target: frame
    value: IM_MAIN

  #step:93frame0:検索、frame1:detail
  - command: switchTo
    target: frame
    value: 1

  #step:94未処理案件一覧（本人用）へ戻る
  - command: ifnot
    target: XPathFormat=//*[contains(text(),"{0}")]/parent::tr/td[1]/a; goto:complete
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:95#特定WFへ
  - command: click
    target: XPathFormat=//*[contains(text(),"{0}")]/parent::tr/td[1]/a
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:96
  - command: wait
    target: 
    value: 1

  #step:97＃BPW申請－共通
  - command: switchTo
    target: DefaultContent
    value: 

  #step:98
  - command: switchTo
    target: frame
    value: 0

  #step:99
  - command: switchTo
    target: frame
    value: 1

  #step:100
  - command: type
    target: name=receive_comment
    value: name=receive_comment:1800_Entertainment-Acctg--2021-04-05-100902:OK

  #step:101
  - command: click
    target: name=save
    value: 

  #step:102
  - command: switchTo
    target: alert
    value: 

  #step:103
  - command: sendkeys
    target: 
    value: "{enter}"

  #step:104ルーt１を選択
  - command: jump
    target: goto:im_bpw_not_comp
    value: 

  #step:105
  - command: label
    target: complete
    value: 

  #step:106メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:107処理済案件一覧（本人用）
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_consented
    value: 

  #step:108
  - command: switchTo
    target: frame
    value: IM_MAIN

  #step:109frame0:検索、frame1:detail
  - command: switchTo
    target: frame
    value: 1

  #step:110#特定WFへ
  - command: popup
    target: XPathFormat=//*[contains(text(),"{0}")]/parent::tr/td[4]/a
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:111
  - command: wait
    target: 
    value: 1000

  #step:112
  - command: click
    target: linktext=閉じる
    value: 

  #step:113メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:114処理済案件一覧（本人用）
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_consented
    value: 

  #step:115
  - command: switchTo
    target: frame
    value: IM_MAIN

  #step:116frame0:検索、frame1:detail
  - command: switchTo
    target: frame
    value: 1

  #step:117フロー詳細
  - command: popup
    target: XPathFormat=//*[contains(text(),"{0}")]/parent::tr/td[4]/img
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:118
  - command: wait
    target: 
    value: 1000

  #step:119
  - command: click
    target: linktext=閉じる
    value: 

  #step:120メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:121処理済案件一覧（本人用）
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_consented
    value: 

  #step:122
  - command: switchTo
    target: frame
    value: IM_MAIN

  #step:123frame0:検索、frame1:detail
  - command: switchTo
    target: frame
    value: 1

  #step:124フロー
  - command: popup
    target: XPathFormat=//*[contains(text(),"{0}")]/parent::tr/td[5]/img
    value: 1800_Entertainment-Acctg--2021-04-05-100902

  #step:125
  - command: wait
    target: 
    value: 1000

  #step:126
  - command: click
    target: linktext=閉じる
    value: 

  #step:127メイン画面へ戻る
  - command: switchwindow
    target: 
    value: root

  #step:128参照案件一覧
  - command: open
    target: http://localhost:8080/imart/menu/common/iframe_sender?menuId=im_bpw_reference
    value: 

  #step:129route2で再起票
  - command: ifvar
    target: routeX=2;goto:draft01
    value: 

  #step:130ログアウト
  - command: open
    target: http://localhost:8080/imart/logout
    value: 

  #step:131
  - command: close
    target: 
    value: 

